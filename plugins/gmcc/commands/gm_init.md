---
name: gm_init
description: Initialize the GM-CDE system at the user level. Creates ~/gmcc_ckfs/ root structure. Run once per machine, then use /gm_repo_init for each repository.
argument-hint: [--force]
disable-model-invocation: true
allowed-tools: Bash, Read, Write, Glob, AskUserQuestion
---

# Initialize GM-CDE System

You are initializing the GM-CDE system at the user level.

**IMPORTANT**: This command ONLY creates the system-level `~/gmcc_ckfs/` directory. After running this, use `/gm_repo_init` in each repository you want to use with GM-CDE.

## Pre-Flight Checks

First, verify:
1. `~/gmcc_ckfs/` does NOT already exist (unless `--force` in $ARGUMENTS)

### If Already Initialized (Without --force)
Use AskUserQuestion:
```
GM-CDE system already initialized at ~/gmcc_ckfs/

What would you like to do?
- Reinitialize (wipe ALL repositories) - WARNING: This will delete ALL CKFS data
- Keep existing (exit without changes)
- Initialize a repository instead (run /gm_repo_init)
```

## Directory Structure Creation

Create the system-level structure:

```
~/gmcc_ckfs/
└── README.md
```

### README.md
```markdown
# GMCC CKFS (Context Knowledge File System)

This directory contains GM-CDE runtime data for all repositories.

## Structure

```
~/gmcc_ckfs/
├── README.md                    # This file
└── {repo_name}/                 # Per-repository CKFS
    ├── REPOSITORY_INDEX.md      # Cross-repo relationships
    ├── GREATER_PURPOSE.md       # Project vision
    ├── SRC_INDEX.md             # Source file index
    ├── FAM_INDEX.md             # Branch index
    ├── CHANGELOG.md             # Change history
    ├── resource/                # Reference materials
    ├── gmcc_plugin_template/    # Evolution target
    └── fam/                     # Feature Access Memory
        └── {branch}/            # Per-branch context
            ├── Purpose.md
            ├── Tasks.md
            ├── ChangedFiles.md
            ├── Famalouge.md
            ├── ECLAIR_BRAIN.md
            └── thoughts/
```

## Usage

1. Run `/gm_init` once to create this directory (already done)
2. Run `/gm_repo_init` in each repository to initialize its CKFS
3. Run `/gm_load_branch` or `/gm_feature_dev` to start working

## Environment Variables

Set automatically by SessionStart hook:
- `GMCC_CKFS_ROOT` - This directory (~/gmcc_ckfs)
- `GMCC_REPO_ID` - Current repository name
- `GMCC_REPO_PATH` - Current repo's CKFS path
- `GMCC_FAM_PATH` - Current branch's FAM path
- `GMCC_PLUGIN_ROOT` - Plugin installation path

---
*Generated by GM-CDE*
```

## Post-Initialization

After creating the structure:

1. **Verify Creation**:
   - Check that `~/gmcc_ckfs/` exists
   - Check that `~/gmcc_ckfs/README.md` was created

2. **Report Success**:
```
[GMB] GM-CDE system initialized!

Created:
- ~/gmcc_ckfs/
- ~/gmcc_ckfs/README.md

Next steps:
1. Navigate to a git repository
2. Run /gm_repo_init to initialize that repository
3. Start development with /gm_feature_dev or /gm_task

Note: The SessionStart hook will automatically detect git repositories
and set GMCC_* environment variables when you open Claude Code.
```
